(this.webpackJsonpcheckinout=this.webpackJsonpcheckinout||[]).push([[0],{120:function(e,t){},125:function(e,t,n){},126:function(e,t,n){},22:function(e){e.exports=JSON.parse('{"loading":"Loading in progress...","noSheet":"\u2757 Could not find spreadsheet with today\'s date!","reloadPage":"Please create the spreadsheet for today and reload the app to check in!","loaded":"\u2705 Ready to check in!","noStudent":"\u2757 Student ID could not be found!","checkIn":"\ud83d\udc4b Checked in {0} at {1}!","checkOut":"\ud83d\udeaa Checked out {0} at {1}!","alreadyDone":"\ud83d\udfe1 {0} is already accounted for!","failedToOpen":"\u2757 Could not find data to use.","succeededToOpen":"\u2705 Found ID data."}')},237:function(e){e.exports=JSON.parse('{"type":"service_account","project_id":"myproject-361608","private_key_id":"63d17026f60b401cb267fe3722332386fff3d568","private_key":"-----BEGIN PRIVATE KEY-----\\nMIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCo4+l8Zalr6yA5\\nRuROZ8Ocorw+A62FZpbMRpQD+sIWw1Z5wk6O4hYyyrrYkc5RQpWH6brBQHiQduv5\\nwI2mEpQED+5gn0S3Dla7Ws35Ap2w5d4wr4ZY4dGTWFN/E3DbRKuOFXfXMuFKxp0P\\nGXO8k0bCPjwuVvgHqM/rAnBmu3ItZgzHKoUco0OCj7RhXpwX8hfBcBBK3OMjo117\\nA2oE5iiZ1PqlpQuuINN4VB+ObifpJb52dWTUxmambvKf+XSpJyHVBFqbuNXMMvDg\\nrIy0RWE6iAAJYEfN8bZuAcRmaFQU9FFYwpv3rS5fOe65lQOQakfRXqpTogEin6Qf\\nNoh+MaMNAgMBAAECggEAHeKUfIltuRW2UkRP3mrgk409U5jpgc9FNFjx1KFw6j+/\\nA9Uk+wYZKPw0I2HrmPf4B0CN5iffHasZdwyCVCZ58B0UkJ7mNSExqj33cA5tMnH+\\nhu1sT7qHz/OjdLtPL1GfrMjyN49+i7GI9bTKhM4nyXPjSMzlX0+ZGQwJsTgOjGc2\\ndpYEsZqXgjMm/LEKXMPWMsG3S9RRGLF7CEYzEwwAE+AYhG5Onp659AZmu3E09D4w\\nXHO9NwvDDXrAO9D0sq95wBnLr8YFDejesPA6ZAlKXhZrHzplC/FO7xREbC70gmCh\\nu//H1b8+JZ4aMWOB3BXALek+fXGK+zlJZq0SKGDIKQKBgQDc/QPHjErJUe0a5PIM\\nvQkFxpBgCfhpPyCTPIyeOFQRtf0n6GcqRNBbJ2475EC/rtnBNNnwTu7mhVfZsN20\\nxHLWv4kFQLJRwsaN9bmiEi5iXb/BkUskMUu4H0FZh3Xl2YIBTB+lOZz4v1AovQWC\\niZ6eXtYW/kRmJNKelrzAsR4s1QKBgQDDpd8IwplSEUYbJ0TAdF08atoUijZtHzZp\\nGL/B/3DyQ7ppEgZ0R2pzaOcFQAIevDHk536IdLZFC5lQYqPZHHIaNTVQ1CF07vZk\\nenHV+0ZjM8NVTAw8nC65XSggYR8P8opM5phh6UHUy4tzULkh28kDN8sQAoAVPNpE\\n+8Ieb6ZZWQKBgAIFEf7F6n0SkZ84TnoNVELIQNOP48Raflq6J/LeQu5ygmDV//Nj\\n85+RqbFEcc8OsxDQAdnvbsGOoHHt6ujXDtGlqIPyxm524Ee14j93+RKPFsyXHl+z\\nT6TcLEW8Njiml0iZwIRLFYM0hHAK4j0CMv/xj/Vf15IzbfVjHVCJjeQNAoGAD4nb\\n9eEmtirjC4MJ5dMYGJVP7rOvcOk6tAwgJrM38DXK1090LcYCQVpChts3j+NYfxqX\\npRTH6SHrskOzSaoFsekp69p9McFM1lwXMGx9gaF50QtyKVoqJ9SrPC8afXTA4Syr\\nS5NwBAuKbsUpfvPquhOzT/ky3PzxROtN1ob9ijkCgYBXiwK7/9q8Qk9eCAk4QLil\\nVIFe6tSdavFuU1x/1SghhGivcPd4+o69Hz9XI0Rwd4UgVhcVnI7cCzy3d8FxhdqP\\n8cbV65es6063OZz5aMnso9/P3tzHp1UI741D3+sM07j61ch6Q473IgLwBRIq5Ol9\\nHCca+BPTh4XrEpxRtUoT3A==\\n-----END PRIVATE KEY-----\\n","client_email":"react-test@myproject-361608.iam.gserviceaccount.com","client_id":"103380732364670801995","auth_uri":"https://accounts.google.com/o/oauth2/auth","token_uri":"https://oauth2.googleapis.com/token","auth_provider_x509_cert_url":"https://www.googleapis.com/oauth2/v1/certs","client_x509_cert_url":"https://www.googleapis.com/robot/v1/metadata/x509/react-test%40myproject-361608.iam.gserviceaccount.com"}')},242:function(e,t,n){},264:function(e,t){},266:function(e,t){},309:function(e,t){},311:function(e,t){},343:function(e,t){},345:function(e,t){},346:function(e,t){},351:function(e,t){},353:function(e,t){},359:function(e,t){},361:function(e,t){},380:function(e,t){},392:function(e,t){},395:function(e,t){},42:function(e){e.exports=JSON.parse('{"name":["Name","name","\uc774\ub984"],"id":["ID"],"class":["Class","\ud559\uae09"],"grade":["Grade","\ud559\ub144/\uc131\ubcc4"],"checkIn":["Check in"],"checkOut":["Check out"],"absence":["Absence","\uacb0\uc11d \ubc30\uc815"],"total":["Total"],"print":["Print","print"]}')},444:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(65),i=n.n(a),s=(n(242),n(3)),o=n(9),u=(n(125),n(20)),l=n(7),d=n(19),h=n(16),f=(n(243),n(235)),b=n.n(f),p=n(2),j=0;var O=function(e){var t=Object(r.useRef)(),n=Object(r.useRef)(),c=Object(r.useState)(),a=Object(l.a)(c,2),i=a[0],s=a[1],o=Object(r.useState)(!1),u=Object(l.a)(o,2),d=u[0],h=u[1];function f(){if(e.periodic()&&(h(!0),setTimeout((function(){h(!1)}),300)),!(--j>0))if(t.current.readyState!==t.current.HAVE_ENOUGH_DATA);else{n.current.height=t.current.videoHeight,n.current.width=t.current.videoWidth;var r=n.current.getContext("2d");r.drawImage(t.current,0,0,n.current.width,n.current.height);var c=r.getImageData(0,0,n.current.width,n.current.height),a=b()(c.data,c.width,c.height,{inversionAttempts:"dontInvert"});a&&(console.log(a.data),s({data:a.data,time:new Date}),j=5)}}return Object(r.useEffect)((function(){i&&(e.onScan(i.data),s(null))}),[i]),Object(r.useEffect)((function(){var e=setInterval((function(){requestAnimationFrame(f)}),200);return function(){clearInterval(e)}}),[]),Object(r.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then((function(e){console.log(e);try{t.current.srcObject=e,t.current.setAttribute("playsinline",!0),t.current.play()}catch(n){}}))}),[t,n]),Object(p.jsxs)("div",{children:[Object(p.jsx)("video",{style:{filter:d?"brightness(0%)":"brightness(100%)"},ref:t}),Object(p.jsx)("canvas",{ref:n,hidden:!0})]})},g=function(e){return new Promise((function(t){return setTimeout(t,Math.ceil(1e3*e))}))};String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;t++){var n=new RegExp("\\{"+t+"\\}","gi");e=e.replace(n,arguments[t])}return e};var v={position:"bottom-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0},x=(n(126),n.p+"static/media/Logo.f0526f33.png"),m=n(22),k=[],y=[],w=[],C=!1,S=0;function I(e){w.push([S].concat(Object(d.a)(e))),w.length>5&&w.shift(),S+=1}var A=function(e){var t=Object(r.useState)((new Date).toLocaleDateString()),n=Object(l.a)(t,2),c=n[0],a=n[1],i=Object(r.useState)(""),d=Object(l.a)(i,2),f=d[0],b=d[1];function j(){return(new Date).toLocaleTimeString("en-US",{hour12:!0,hour:"numeric",minute:"numeric"})}function S(){return(S=Object(o.a)(Object(s.a)().mark((function e(t){var n,r;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(new Date).getTime(),console.log("reached function "+n+" "+t),(r=parseInt(t))>0&&k.push({tick:n,id:r}),e.abrupt("return");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){var e=Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{children:"Name"}),Object(p.jsx)("th",{children:"action"}),Object(p.jsx)("th",{children:"time"})]});return Object(p.jsx)("table",{children:Object(p.jsxs)("tbody",{children:[e,w.map((function(e){return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:e[1]},"name"),Object(p.jsx)("td",{children:e[2]},"action"),Object(p.jsx)("td",{children:e[3]},"time")]},e[0])}))]})})}function D(e){var t,n=Object(u.a)(y);try{for(n.s();!(t=n.n()).done;){if(t.value.id===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}return Object(r.useEffect)((function(){console.log("Update today data "+c)}),[c]),Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(s.a)().mark((function t(){var n,r,c,i,o,u;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Wait for sheet"),(n=v).autoClose=!1,r=h.c.info(m.loading,v);case 4:if(e.doc.isOpen()){t.next=10;break}return console.log("check"),t.next=8,g(1);case 8:t.next=4;break;case 10:return console.log("done"),c=new Date,t.next=14,e.doc.sheetsByDate(c);case 14:if(i=t.sent){t.next=21;break}return h.c.dismiss(r),n.autoClose=3e3,h.c.warning(m.reloadPage,v),h.c.error(m.noSheet,v),t.abrupt("return");case 21:o=i.sheet,u=i.date,console.log("tS"),console.log(o.title),a(u),n.type=h.c.TYPE.SUCCESS,n.autoClose=3e3,n.render=m.loaded,h.c.update(r,n);case 30:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e]),Object(r.useEffect)((function(){function t(e){return n.apply(this,arguments)}function n(){return(n=Object(o.a)(Object(s.a)().mark((function t(n){var r,c,a;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("handling scanning "+n),r=j(),t.next=4,e.doc.getStudent(n);case 4:if(c=t.sent){t.next=8;break}return h.c.error(m.noStudent,v),t.abrupt("return");case 8:if(console.log("Student ID: "+n+" Idx:  "+c.idx),a=null,null!=c.checkIn.valueType){t.next=16;break}c.checkIn.value=r,a="Check In",h.c.success(m.checkIn.format(c.name.value,r),v),t.next=24;break;case 16:if(null!=c.checkOut.valueType){t.next=22;break}c.checkOut.value=r,a="Check Out",h.c.success(m.checkOut.format(c.name.value,r),v),t.next=24;break;case 22:return h.c.warn(m.alreadyDone.format(c.name.value),v),t.abrupt("return");case 24:return console.log(a+" "+r),I([c.name.value,a,r]),t.next=28,e.doc.updateCell();case 28:C=!0;case 29:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var r=setInterval(Object(o.a)(Object(s.a)().mark((function e(){var n,c,a;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=(new Date).getTime(),c=(new Date).toLocaleTimeString("en-US",{hour12:!0,hour:"numeric",minute:"numeric",second:"numeric"}),b(c);y.length>0&&n-y[0].tick>5e3;)y.shift();case 4:if(!(k.length>0)){e.next=14;break}if(a=k.shift(),!(n-a.tick>1e3||D(a.id))){e.next=8;break}return e.abrupt("continue",4);case 8:return y.push(a),e.next=11,t(a.id);case 11:return e.abrupt("break",14);case 14:return e.abrupt("return",(function(){return clearInterval(r)}));case 15:case"end":return e.stop()}}),e)}))),200)}),[]),Object(p.jsxs)("div",{id:"scan",children:[Object(p.jsxs)("div",{id:"title",children:[Object(p.jsx)("img",{id:"logo",src:x,alt:"SVKS"}),Object(p.jsx)("h1",{children:" SVKS Check In/Out "})]}),Object(p.jsxs)("div",{id:"clock",children:[c," ",f]}),Object(p.jsxs)("div",{id:"contents",children:[Object(p.jsx)("div",{id:"reader",children:Object(p.jsx)(O,{onScan:function(e){return S.apply(this,arguments)},periodic:function(){var e=C;return C=!1,e}})}),Object(p.jsxs)("div",{id:"recent",children:[Object(p.jsx)("h2",{children:"Recent Check In/Out"}),Object(p.jsx)(A,{})]})]})]})},D=n(124),E=n.n(D),R=n(446),T=n(236),P=c.a.forwardRef((function(e,t){return Object(p.jsx)("div",{className:"toPrint",ref:t,style:{width:"max(calc(100vw - 30rem), 80%)"},children:e.children})})),M=new Set;var N,F=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),c=n[0],a=n[1],i=Object(r.useState)([]),f=Object(l.a)(i,2),b=f[0],j=f[1],O=Object(r.useState)([]),k=Object(l.a)(O,2),y=k[0],w=k[1],C=Object(R.a)(c,50),S=Object(l.a)(C,1)[0],I=Object(r.useState)([]),A=Object(l.a)(I,2),D=A[0],N=A[1],F=Object(r.useState)([]),B=Object(l.a)(F,2),L=B[0],H=B[1],Q=Object(r.useRef)(),Z=Object(T.useReactToPrint)({content:function(){return Q.current}});function U(){return(U=Object(o.a)(Object(s.a)().mark((function e(){var t,n,r,c,a;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=0;n<y.length;n++)y[n]&&"x"===y[n].toLowerCase()&&null!=b[n].id&&(r=b[n],c="".concat(r.name,":  ").concat(r.id),a={text:c,name:r.name,id:r.id.toString()},t.push(a),M.add(r.id));H([].concat(Object(d.a)(L),t));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(s.a)().mark((function t(){var n,r,c,a,i,o,u,l,d;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Wait for sheet"),(n=v).autoClose=!1,console.log(n),r=h.c.info(m.loading,n);case 5:if(e.doc.isOpen()){t.next=11;break}return console.log("check"),t.next=9,g(1);case 9:t.next=5;break;case 11:return t.next=13,e.doc.findMostRecentSheet();case 13:if(c=t.sent){t.next=19;break}return h.c.dismiss(r),n.autoClose=3e3,h.c.error(m.failedToOpen,v),t.abrupt("return");case 19:return console.log(c.date),a=c.idList,i=c.header.name,t.next=24,e.doc.readList(i);case 24:for(o=t.sent,u=[],l=0;l<Math.min(a.length,o.length);l++)u.push({id:a[l],name:o[l]});if(j(u),!(d=c.header.print)){t.next=37;break}return t.t0=w,t.next=33,e.doc.readList(d);case 33:t.t1=t.sent,(0,t.t0)(t.t1),t.next=38;break;case 37:w([]);case 38:console.log("Sheet read "+u.length),n.type=h.c.TYPE.SUCCESS,n.autoClose=3e3,n.render=m.succeededToOpen,h.c.update(r,n);case 43:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){function e(e){return t.apply(this,arguments)}function t(){return(t=Object(o.a)(Object(s.a)().mark((function e(t){var n,r,c,a,i,o;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=Object(u.a)(b),e.prev=2,r.s();case 4:if((c=r.n()).done){e.next=11;break}if(a=c.value,!(n.length>4)){e.next=8;break}return e.abrupt("break",11);case 8:(a.id&&a.id.toString().includes(t)||a.name&&a.name.toString().includes(t))&&(i="".concat(a.name,":  ").concat(a.id),o={text:i,name:a.name,id:a.id.toString()},n.push(o),M.add(a.id));case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}}),e,null,[[2,13,16,19]])})))).apply(this,arguments)}function n(){return(n=Object(o.a)(Object(s.a)().mark((function t(){var n;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!S){t.next=7;break}return t.next=3,e(S);case 3:(n=t.sent).length>0&&N(n),t.next=8;break;case 7:N([]);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[S,b]),Object(p.jsxs)("div",{id:"print",children:[Object(p.jsxs)("div",{id:"title",children:[Object(p.jsx)("img",{id:"logo",src:x,alt:"SVKS"}),Object(p.jsx)("h1",{children:" Print QR Codes "})]}),Object(p.jsxs)("div",{id:"printContents",children:[Object(p.jsx)("input",{id:"search",placeholder:"Search for student or enter a number...",value:c,onChange:function(e){a(e.target.value)}}),D.map((function(e){return Object(p.jsx)("div",{id:"searchResult",onClick:function(){M.has(e.id)||(H([].concat(Object(d.a)(L),[e])),M.add(e.id))},children:Object(p.jsxs)("h4",{children:[" ",e.text," "]})},e.id)}))]}),L.length>0&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{id:"selected",children:L.map((function(e){return Object(p.jsxs)("div",{id:"selectedItem",children:[Object(p.jsx)(E.a,{size:100,value:e.id}),Object(p.jsxs)("p",{id:"qrName",children:[" ",e.text," "]}),Object(p.jsx)("button",{id:"deleteButton",onClick:function(){H(L.filter((function(t){return parseInt(t.id)!==parseInt(e.id)}))),M.delete(e.id)},children:" X "})]},e.id)}))}),Object(p.jsx)(P,{ref:Q,children:Object(p.jsx)("div",{id:"qrList",children:L.map((function(e){return Object(p.jsxs)("div",{id:"qrCode",children:[Object(p.jsx)(E.a,{size:160,value:e.id}),Object(p.jsx)("p",{id:"qrName",children:e.text})]},e.id)}))})}),Object(p.jsx)("button",{id:"printButton",onClick:Z,children:"Print codes."})]}),Object(p.jsx)("button",{id:"printButton",onClick:function(){return U.apply(this,arguments)},children:"Print codes for marked students."})]})},B=n(85),L=n(4),H=n(34),Q=n(35),Z={production:"1FqeRNFlZZ7aJdtYRmjZ1kRb2-sarN9aoTMGyu4jhGKs",development:"12AWolV6lI99LM6NNP1bUwYanAuNDSWRJI8X4-ozM98Q"},U=n(237),X=n(42),K=n(254).GoogleSpreadsheet,Y=65;console.log("Production mode"),N="production";var V=[{year:"numeric",month:"numeric",day:"numeric"},{year:"2-digit",month:"numeric",day:"numeric"},{year:"numeric",month:"2-digit",day:"numeric"},{year:"2-digit",month:"2-digit",day:"numeric"},{year:"numeric",month:"numeric",day:"2-digit"},{year:"2-digit",month:"numeric",day:"2-digit"},{year:"numeric",month:"2-digit",day:"2-digit"},{year:"2-digit",month:"2-digit",day:"2-digit"}];function q(e,t){var n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),r=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.abs(Math.floor((r-n)/864e5))}function z(e,t){var n,r=Object(u.a)(t);try{for(r.s();!(n=r.n()).done;){if(n.value===e)return!0}}catch(c){r.e(c)}finally{r.f()}return!1}var G=function(){function e(){Object(H.a)(this,e),console.log("Create Doc class");var t=new K(Z[N]);this.state={doc:t,initialized:!1,sheet:null,header:null,idList:null}}return Object(Q.a)(e,[{key:"openDoc",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("try to read sheet"),e.next=3,this.state.doc.useServiceAccountAuth(U);case 3:return console.log("Auth Done"),e.next=6,this.state.doc.loadInfo();case 6:console.log("Done"),this.state.initialized=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isOpen",value:function(){return this.state.initialized}},{key:"sheetsByTitle",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(t){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.doc.sheetsByTitle[t];case 2:return this.state.sheet=e.sent,e.abrupt("return",this.state.sheet);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sheetsByDate",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(t){var n,r,c,a,i,o;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.sheet=null,n=null,r=Object(u.a)(V),e.prev=3,r.s();case 5:if((c=r.n()).done){e.next=15;break}return a=c.value,e.next=9,this.state.doc.sheetsByTitle[t.toLocaleDateString("en-US",a)];case 9:if(this.state.sheet=e.sent,n=t.toLocaleDateString("en-US",a),!this.state.sheet){e.next=13;break}return e.abrupt("break",15);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:if(this.state.sheet){e.next=25;break}return e.abrupt("return",null);case 25:return console.log(n),console.log("Found sheet "+this.state.sheet),e.next=29,this.state.sheet.loadCells("A1:Z1");case 29:return i=this.createHeader(this.state.sheet),console.log(i),e.next=33,this.readList(i.id,this.state.sheet);case 33:return o=e.sent,this.state.header=i,this.state.idList=o,e.abrupt("return",{sheet:this.state.sheet,date:n,header:i,idList:o});case 37:case"end":return e.stop()}}),e,this,[[3,17,20,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.sheet,t=null,n=null,r=null,c=null,a=null,i=null;if(!e)return{};for(var s=0;s<Math.min(26,e.columnCount);s++){var o=e.getCell(0,s);null!=o.valueType&&(n=z(o.value,X.name)?s:n,t=z(o.value,X.id)?s:t,r=z(o.value,X.class)?s:r,c=z(o.value,X.checkIn)?s:c,a=z(o.value,X.checkOut)?s:a,i=z(o.value,X.print)?s:i)}return{id:t,name:n,class:r,checkIn:c,checkOut:a,print:i}}},{key:"readList",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(t){var n,r,c,a,i,o,u,l,d,h,f,b,p=arguments;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p.length>1&&void 0!==p[1]?p[1]:this.state.sheet,r=0,c=100,a=[],n){e.next=6;break}return e.abrupt("return",[]);case 6:i=null,o=n.rowCount;case 8:if(!(r<o-1)){e.next=21;break}return u=Math.min(o-r,c),l=String.fromCharCode(Y+t)+(r+1)+":"+String.fromCharCode(Y+t)+(r+u),e.next=13,n.loadCells(l);case 13:for(console.log(l),d=0,h=0;h<c;h++)f=n.getCell(r+h,t),b=null,null==f.valueType?d++:(b=f.value,i=r+h),a.push(b);if(d!==c){e.next=18;break}return e.abrupt("break",21);case 18:r+=u,e.next=8;break;case 21:return a[0]="",a=a.slice(0,i+1),e.abrupt("return",a);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getStudent",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(t){var n,r,c,a,i,o,u,l,d;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state.sheet){e.next=3;break}return e.abrupt("return",null);case 3:if(r=t,c=this.findStudentRow(r)){e.next=7;break}return e.abrupt("return",null);case 7:return a=this.state.header,console.log("Student ID: "+r+" Index:"+c),i=String.fromCharCode(Y)+c+":"+String.fromCharCode(90)+c,console.log(i),e.next=13,n.loadCells(i);case 13:return o=c-1,console.log("Get Cell "+o+" "+a.name),u=n.getCell(o,a.name),l=n.getCell(o,a.checkIn),d=n.getCell(o,a.checkOut),e.abrupt("return",{idx:o,name:u,checkIn:l,checkOut:d});case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCell",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(){var t;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.sheet){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,t.saveUpdatedCells();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"findStudentRow",value:function(e){var t=this.state.idList;console.log("finding student row "+t.length);for(var n=0;n<t.length;n++)if(t[n]&&t[n]===e)return n+1;return null}},{key:"findMostRecentSheet",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(){var t,n,r;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new Date,n=new Date;case 2:if(!(q(n,t)<400)){e.next=11;break}return e.next=5,this.sheetsByDate(t);case 5:if(!(r=e.sent)){e.next=8;break}return e.abrupt("return",r);case 8:t.setDate(t.getDate()-1),e.next=2;break;case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),J=new G;var W=function(){return Object(r.useEffect)((function(){function e(){return(e=Object(o.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Initialize app"),J.openDoc();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(p.jsxs)(B.a,{children:[Object(p.jsx)("div",{children:Object(p.jsx)("nav",{id:"nav",children:Object(p.jsxs)("tr",{id:"nav",children:[Object(p.jsx)("td",{id:"nav",children:Object(p.jsx)(B.b,{to:"/",children:"Scan"})}),Object(p.jsx)("td",{id:"nav",children:Object(p.jsx)(B.b,{to:"/print",children:"Print"})})]})})}),Object(p.jsx)("hr",{}),Object(p.jsxs)("div",{className:"App",children:[Object(p.jsxs)(L.c,{children:[Object(p.jsx)(L.a,{path:"/",element:Object(p.jsx)(A,{doc:J})}),Object(p.jsx)(L.a,{path:"print",element:Object(p.jsx)(F,{doc:J})})]}),Object(p.jsx)(h.a,{position:"bottom-center",autoClose:3e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,draggable:!0,pauseOnHover:!0,pauseOnFocusLoss:!1,transition:h.b,icon:!1}),Object(p.jsx)("h2",{children:"v 1.8.1"})]})]})},_=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,447)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))};i.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(W,{})}),document.getElementById("root")),_()}},[[444,1,2]]]);
//# sourceMappingURL=main.410caa31.chunk.js.map