{"version":3,"sources":["components/Reader.js","Util.js","images/Logo.png","pages/Scan.js","components/ToPrint.js","pages/Print.js","Doc.js","api/spreadsheetID.js","App.js","reportWebVitals.js","index.js"],"names":["delayCount","Reader","props","video","useRef","canvasRef","useState","result","setResult","black","setBlack","tick","periodic","setTimeout","current","readyState","HAVE_ENOUGH_DATA","height","videoHeight","width","videoWidth","canvas","getContext","drawImage","imageData","getImageData","code","jsQR","data","inversionAttempts","console","log","time","Date","useEffect","onScan","inter","setInterval","requestAnimationFrame","clearInterval","navigator","mediaDevices","getUserMedia","facingMode","then","stream","srcObject","setAttribute","play","style","filter","ref","hidden","sleep","Promise","resolve","Math","ceil","String","prototype","format","formatted","this","i","arguments","length","regexp","RegExp","replace","toastProp","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","scanList","scanHistory","recentList","shutter","recentCount","addToRecentList","value","push","shift","Scan","toLocaleDateString","todayDate","setTodayDate","currentTimeSec","setCurrentTimeSec","getCurrentTime","toLocaleTimeString","hour12","hour","minute","getTime","id","parseInt","Recent","header","map","entry","checkDuplicate","prop","initNoti","toast","info","text","loading","doc","isOpen","tD","sheetsByDate","dismiss","warning","reloadPage","error","noSheet","tS","sheet","date","title","type","TYPE","SUCCESS","render","loaded","update","initialize","checkId","currentTime","getStudent","noStudent","idx","action","checkIn","valueType","success","name","checkOut","warn","alreadyDone","updateCell","interval","timeSec","second","src","Logo","alt","ret","ToPrint","React","forwardRef","className","children","selectedIds","Set","Print","sheetKey","inputText","setInputText","studentList","setStudentList","printList","setPrintList","useDebounce","searchQuery","searchResults","setSearchResults","selectedCodes","setSelectedCodes","printRef","handlePrint","useReactToPrint","content","results","toLowerCase","resultString","resultObject","toString","add","findMostRecentSheet","sheetInfo","failedToOpen","idList","nameIdx","readList","nameList","list","min","printIdx","print","succeededToOpen","findStudents","row","includes","sr","query","placeholder","onChange","event","target","onClick","has","size","c","delete","spreadsheetID","production","development","GoogleSpreadsheet","require","ASCII_A","dateFormatOptions","year","month","day","dateDiffInDays","a","b","utc1","UTC","getFullYear","getMonth","getDate","utc2","abs","floor","findHeader","headers","Doc","state","initialized","useServiceAccountAuth","config","loadInfo","arg","sheetsByTitle","dateStr","option","loadCells","createHeader","idIdx","classIdx","checkInIdx","checkOutIdx","columnCount","getCell","class","rowIdx","ROW_RANGE","ids","lastIdx","rowSize","rowCount","increment","fromCharCode","nullCount","slice","todaySheet","studentNumber","studentRowNumber","findStudentRow","saveUpdatedCells","ID","sheetDate","today","setDate","App","openDoc","to","path","element","newestOnTop","rtl","pauseOnFocusLoss","transition","Zoom","icon","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.410caa31.chunk.js","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport jsQR from \"jsqr\";\r\nimport \"../App.css\";\r\n\r\nconst PAUSE_COUNT = 5;\r\nlet delayCount = 0;\r\nfunction Reader(props) {\r\n    const video = useRef();\r\n    const canvasRef = useRef();\r\n    const [result, setResult] = useState();\r\n    const [black, setBlack] = useState(false);\r\n\r\n    function shutter() {\r\n        setBlack(true);\r\n        setTimeout(() => {\r\n            setBlack(false);\r\n        }, 300);\r\n    }\r\n\r\n    useEffect(\r\n        function () {\r\n            if (result) {\r\n                props.onScan(result.data);\r\n                setResult(null);\r\n            }\r\n        },\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n        [result]\r\n    );\r\n\r\n    useEffect(function () {\r\n        const inter = setInterval(() => {\r\n            requestAnimationFrame(tick);\r\n        }, 200);\r\n        return () => {\r\n            clearInterval(inter);\r\n        };\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    useEffect(\r\n        function () {\r\n            navigator.mediaDevices\r\n                .getUserMedia({ video: { facingMode: \"environment\" } })\r\n                .then(function (stream) {\r\n                    console.log(stream);\r\n                    try {\r\n                        video.current.srcObject = stream;\r\n                        video.current.setAttribute(\"playsinline\", true); // required to tell iOS safari we don't want fullscreen\r\n                        video.current.play();\r\n                    } catch {}\r\n                });\r\n        },\r\n        [video, canvasRef]\r\n    );\r\n\r\n    function tick() {\r\n        if (props.periodic()) shutter();\r\n        if (--delayCount > 0) return;\r\n        if (video.current.readyState === video.current.HAVE_ENOUGH_DATA) {\r\n            canvasRef.current.height = video.current.videoHeight;\r\n            canvasRef.current.width = video.current.videoWidth;\r\n\r\n            var canvas = canvasRef.current.getContext(\"2d\");\r\n\r\n            canvas.drawImage(\r\n                video.current,\r\n                0,\r\n                0,\r\n                canvasRef.current.width,\r\n                canvasRef.current.height\r\n            );\r\n            var imageData = canvas.getImageData(\r\n                0,\r\n                0,\r\n                canvasRef.current.width,\r\n                canvasRef.current.height\r\n            );\r\n            var code = jsQR(imageData.data, imageData.width, imageData.height, {\r\n                inversionAttempts: \"dontInvert\",\r\n            });\r\n            if (code) {\r\n                console.log(code.data);\r\n                setResult({ data: code.data, time: new Date() });\r\n                delayCount = PAUSE_COUNT;\r\n            } \r\n            return;\r\n        } \r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <video\r\n                style={{\r\n                    filter: black ? \"brightness(0%)\" : \"brightness(100%)\",\r\n                }}\r\n                ref={video}\r\n            ></video>\r\n            <canvas ref={canvasRef} hidden></canvas>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Reader;\r\n","export const sleep = (time) => {\n   return new Promise((resolve) => setTimeout(resolve, Math.ceil(time * 1000)));\n};\n\ninterface String\n{\n    format: () => String;\n}\n\n// eslint-disable-next-line no-extend-native\nString.prototype.format = function() {\n    let formatted = this;\n    for (let i = 0; i < arguments.length; i++) {\n        let regexp = new RegExp('\\\\{'+i+'\\\\}', 'gi');\n        formatted = formatted.replace(regexp, arguments[i]);\n    }\n    return formatted;\n}\n\nexport const toastProp = {\n    position: \"bottom-center\",\n    autoClose: 3000,\n    hideProgressBar: false,\n    closeOnClick: true,\n    pauseOnHover: true,\n    draggable: true,\n    progress: undefined\n}\n","export default __webpack_public_path__ + \"static/media/Logo.f0526f33.png\";","import React, { useEffect, useState } from \"react\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport Reader from \"../components/Reader\";\r\nimport { sleep, toastProp } from \"../Util\";\r\n\r\nimport \"./Scan.css\";\r\nimport Logo from \"../images/Logo.png\";\r\nimport text from \"../api/text\";\r\n\r\nconst SCAN_INTERVAL = 1000;\r\nconst CHECK_INTERVAL = 5000;\r\nconst scanList = [];\r\nconst scanHistory = [];\r\nconst recentList = [];\r\nlet shutter = false;\r\n\r\nlet recentCount = 0;\r\nfunction addToRecentList(value) {\r\n    recentList.push([recentCount, ...value]);\r\n    if (recentList.length > 5) recentList.shift();\r\n    recentCount += 1;\r\n}\r\n\r\nfunction Scan(props) {\r\n    const [todayDate, setTodayDate] = useState(new Date().toLocaleDateString());\r\n    const [currentTimeSec, setCurrentTimeSec] = useState(\"\");\r\n\r\n    useEffect(function() {\r\n        console.log(\"Update today data \" + todayDate);\r\n    }, [todayDate]);\r\n\r\n    useEffect(function () {\r\n        async function initialize() {\r\n            console.log(\"Wait for sheet\");\r\n            const prop = toastProp;\r\n            prop[\"autoClose\"] = false;\r\n            const initNoti = toast.info(text.loading, toastProp);\r\n            while (!props.doc.isOpen()) {\r\n                console.log(\"check\");\r\n                await sleep(1.0);\r\n            }\r\n            console.log(\"done\");\r\n            let tD = new Date();\r\n            const result = await props.doc.sheetsByDate(tD);\r\n            if (!result)\r\n            {\r\n                toast.dismiss(initNoti);\r\n                prop.autoClose = 3000;\r\n                toast.warning(\r\n                    text.reloadPage, toastProp);\r\n                toast.error(text.noSheet, toastProp);\r\n                return;\r\n            }\r\n            const tS = result.sheet;\r\n            const date = result.date;\r\n            console.log(\"tS\");\r\n            console.log(tS.title);\r\n            setTodayDate(date);\r\n\r\n            prop.type = toast.TYPE.SUCCESS;\r\n            prop.autoClose = 3000;\r\n            prop.render = text.loaded;\r\n            toast.update(initNoti, prop);\r\n        }\r\n        initialize();\r\n\r\n    }, [props]);\r\n\r\n    function getCurrentTime() {\r\n        return new Date().toLocaleTimeString(\"en-US\", {\r\n            hour12: true,\r\n            hour: \"numeric\",\r\n            minute: \"numeric\",\r\n        });\r\n    }\r\n\r\n    async function handleScan(data) {\r\n        const tick = new Date().getTime();\r\n        console.log(\"reached function \" + tick + \" \" + data);\r\n        const id = parseInt(data);\r\n        if (id > 0) scanList.push({tick:tick, id:id});\r\n\r\n        return;\r\n    }\r\n\r\n    function checkShutter() {\r\n        const ret = shutter;\r\n        shutter = false;\r\n        return ret;\r\n    }\r\n\r\n    function Recent() {\r\n        const header = (<tr><th>Name</th><th>action</th><th>time</th></tr>);\r\n        return (<table><tbody>{header}\r\n            {recentList.map(entry => (\r\n                <tr key={entry[0]}>\r\n                    <td key=\"name\">{entry[1]}</td>\r\n                    <td key=\"action\">{entry[2]}</td>\r\n                    <td key=\"time\">{entry[3]}</td>\r\n                </tr>\r\n               ))\r\n            }\r\n        </tbody></table>)\r\n    }\r\n\r\n    function checkDuplicate(id) {\r\n        for (let h of scanHistory)\r\n        {\r\n            if (h.id === id) return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    // Set QR code scan updater\r\n    useEffect(() => {\r\n        async function checkId(id)\r\n        {\r\n            console.log(\"handling scanning \" + id);\r\n\r\n            // Locate student in the spreadsheet today\r\n            const currentTime = getCurrentTime();\r\n\r\n            const info = await props.doc.getStudent(id);\r\n            if (!info)\r\n            {\r\n                // Student does not exist\r\n                toast.error(text.noStudent, toastProp);\r\n                return;\r\n            }\r\n            console.log(\"Student ID: \" + id + \" Idx:  \" + info.idx);\r\n            // Determine action to take\r\n            let action = null;\r\n            if (info.checkIn.valueType == null) {\r\n                // Check student in\r\n                info.checkIn.value = currentTime;\r\n                action = \"Check In\";\r\n\r\n                toast.success(text.checkIn.format(info.name.value, currentTime), toastProp);\r\n            } else if (info.checkOut.valueType == null) {\r\n                // Check student out\r\n                info.checkOut.value = currentTime;\r\n                action = \"Check Out\";\r\n\r\n                toast.success(text.checkOut.format(info.name.value, currentTime), toastProp);\r\n            } else {\r\n                // Student check in and out are both filled\r\n                toast.warn(\r\n                    text.alreadyDone.format(info.name.value), toastProp);\r\n                return;\r\n            }\r\n            console.log(action + \" \" + currentTime);\r\n            addToRecentList([info.name.value, action, currentTime]);\r\n            await props.doc.updateCell();\r\n            shutter = true;\r\n        }\r\n\r\n        const interval = setInterval(async () => {\r\n            const tick = new Date().getTime();\r\n            let timeSec = new Date().toLocaleTimeString(\"en-US\", {\r\n                hour12: true,\r\n                hour: \"numeric\",\r\n                minute: \"numeric\",\r\n                second: \"numeric\"\r\n            });\r\n            setCurrentTimeSec(timeSec);\r\n            while (scanHistory.length > 0 && tick - scanHistory[0].tick > CHECK_INTERVAL)\r\n            {\r\n                scanHistory.shift();\r\n            }\r\n            while (scanList.length > 0)\r\n            {\r\n                let entry = scanList.shift();\r\n\r\n                if (tick - entry.tick > SCAN_INTERVAL || checkDuplicate(entry.id)) continue;\r\n                scanHistory.push(entry);\r\n                await checkId(entry.id);\r\n                break;\r\n            }\r\n            return () => clearInterval(interval);\r\n        }, 200)\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    return (\r\n        <div id=\"scan\">\r\n            <div id=\"title\" >\r\n                <img id=\"logo\" src={Logo} alt=\"SVKS\"/>\r\n                <h1> SVKS Check In/Out </h1>\r\n            </div>\r\n            <div id=\"clock\">\r\n            {todayDate} {currentTimeSec}\r\n            </div>\r\n            <div id=\"contents\">\r\n                <div id=\"reader\">\r\n                    <Reader\r\n                        onScan={handleScan}\r\n                        periodic={checkShutter}/>\r\n                </div>\r\n                <div id=\"recent\">\r\n                    <h2>\r\n                        Recent Check In/Out\r\n                    </h2>\r\n                    <Recent />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Scan;\r\n","import React from \"react\";\r\nexport const ToPrint = React.forwardRef((props, ref) => {\r\n    return (\r\n        <div\r\n            className=\"toPrint\"\r\n            ref={ref}\r\n            style={{\r\n                width: \"max(calc(100vw - 30rem), 80%)\",\r\n                // position: \"absolute\",\r\n                // // top: \"-100%\",\r\n                // zIndex: \"-100\",\r\n            }}\r\n        >\r\n            {props.children}\r\n        </div>\r\n    );\r\n});\r\n\r\nexport default ToPrint;\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport \"./Scan.css\"\r\nimport QRCode from \"react-qr-code\";\r\nimport { toast } from \"react-toastify\";\r\nimport Logo from \"../images/Logo.png\";\r\nimport { useDebounce } from \"use-debounce\";\r\nimport { useReactToPrint } from \"react-to-print\";\r\nimport { ToPrint } from \"../components/ToPrint\";\r\nimport { sleep, toastProp } from \"../Util\";\r\nimport text from \"../api/text\";\r\n\r\nconst selectedIds = new Set();\r\n\r\nfunction Print(props) {\r\n    const [inputText, setInputText] = useState(\"\");\r\n    const [studentList, setStudentList] = useState([]);\r\n    const [printList, setPrintList] = useState([]);\r\n    const [searchQuery] = useDebounce(inputText, 50);\r\n    const [searchResults, setSearchResults] = useState([]);\r\n    const [selectedCodes, setSelectedCodes] = useState([]);\r\n\r\n    const printRef = useRef();\r\n    const handlePrint = useReactToPrint({\r\n        content: () => printRef.current,\r\n    });\r\n\r\n    useEffect(function () {\r\n        async function initialize() {\r\n            console.log(\"Wait for sheet\");\r\n            const prop = toastProp;\r\n            prop.autoClose = false;\r\n            console.log(prop);\r\n            const initNoti = toast.info(text.loading, prop);\r\n            while (!props.doc.isOpen()) {\r\n                console.log(\"check\");\r\n                await sleep(1.0);\r\n            }\r\n\r\n            let sheetInfo = await props.doc.findMostRecentSheet();\r\n\r\n            if (!sheetInfo)\r\n            {\r\n                toast.dismiss(initNoti);\r\n                prop.autoClose = 3000;\r\n                toast.error(text.failedToOpen, toastProp);\r\n                return;\r\n            }\r\n            console.log(sheetInfo.date);\r\n            const idList = sheetInfo.idList\r\n            const nameIdx = sheetInfo.header.name;\r\n            const nameList = await props.doc.readList(nameIdx);\r\n            const list = [];\r\n            for (let i = 0 ; i < Math.min(idList.length, nameList.length); i++)\r\n            {\r\n               list.push({id: idList[i],  name: nameList[i]});\r\n            }\r\n            setStudentList(list);\r\n\r\n            const printIdx = sheetInfo.header.print;\r\n            if (printIdx)\r\n            {\r\n                setPrintList(await props.doc.readList(printIdx));\r\n            }\r\n            else\r\n            {\r\n                setPrintList([]);\r\n            }\r\n            console.log(\"Sheet read \" + list.length);\r\n            prop.type = toast.TYPE.SUCCESS;\r\n            prop.autoClose = 3000;\r\n            prop.render = text.succeededToOpen;\r\n            toast.update(initNoti, prop);\r\n        }\r\n        initialize();\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    useEffect(\r\n        () => {\r\n            async function findStudents(text) {\r\n                let results = [];\r\n\r\n                for (const row of studentList) {\r\n                    if (results.length > 4) break;\r\n                    if ((row.id && row.id.toString().includes(text)) ||\r\n                        (row.name && row.name.toString().includes(text)))\r\n                    {\r\n                        let resultString = `${row.name}:  ${row.id}`;\r\n                        let resultObject = {\r\n                            text: resultString,\r\n                            name: row.name,\r\n                            id: row.id.toString(),\r\n                        };\r\n                        results.push(resultObject);\r\n                        selectedIds.add(row.id);\r\n                    }\r\n                }\r\n                return results;\r\n            }\r\n            async function query() {\r\n                if (searchQuery) {\r\n                    let sr = await findStudents(searchQuery);\r\n                    if (sr.length > 0) setSearchResults(sr);\r\n                } else {\r\n                    setSearchResults([]);\r\n                }\r\n            }\r\n            query();\r\n        },\r\n        [searchQuery, studentList]\r\n    );\r\n\r\n    async function addMarkedStudents() {\r\n        let results = [];\r\n\r\n        for (let i = 0 ; i < printList.length ; i++)\r\n        {\r\n            if (printList[i] && printList[i].toLowerCase() === \"x\" && studentList[i].id != null)\r\n            {\r\n                const entry = studentList[i];\r\n                let resultString = `${entry.name}:  ${entry.id}`;\r\n                let resultObject = {\r\n                    text: resultString,\r\n                    name: entry.name,\r\n                    id: entry.id.toString()\r\n                };\r\n                results.push(resultObject);\r\n                selectedIds.add(entry.id);\r\n            }\r\n        }\r\n        setSelectedCodes([...selectedCodes, ...results]);\r\n    }\r\n\r\n    return (\r\n        <div id=\"print\">\r\n            <div id=\"title\">\r\n                <img id=\"logo\" src={Logo} alt=\"SVKS\" ></img>\r\n                <h1> Print QR Codes </h1>\r\n            </div>\r\n            <div id=\"printContents\" >\r\n                <input id=\"search\"\r\n                    placeholder={\"Search for student or enter a number...\"}\r\n                    value={inputText}\r\n                    onChange={(event) => {\r\n                        setInputText(event.target.value);\r\n                    }} />\r\n\r\n                {searchResults.map((result) => {\r\n                    return (\r\n                        <div key={result.id} id=\"searchResult\"\r\n                            onClick={function () {\r\n                                if (!selectedIds.has(result.id)) {\r\n                                    setSelectedCodes([...selectedCodes, result]);\r\n                                    selectedIds.add(result.id);\r\n                                }\r\n                            }}>\r\n                            <h4> {result.text} </h4>\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n            {selectedCodes.length > 0 && (\r\n                <>\r\n                    <div id=\"selected\">\r\n                        {selectedCodes.map((code) => (\r\n                            <div key={code.id} id=\"selectedItem\">\r\n                                <QRCode size={100} value={code.id} />\r\n                                <p id=\"qrName\"> {code.text} </p>\r\n                                <button id=\"deleteButton\"\r\n                                    onClick={function () {\r\n                                        setSelectedCodes(\r\n                                            selectedCodes.filter(\r\n                                                (c) => parseInt(c.id) !== parseInt(code.id)\r\n                                            )\r\n                                        );\r\n                                        selectedIds.delete(code.id);\r\n                                    }}\r\n                                > X </button>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                    <ToPrint ref={printRef}>\r\n                        <div id=\"qrList\">\r\n                            {selectedCodes.map((code) => (\r\n                                <div key={code.id} id=\"qrCode\" >\r\n                                    <QRCode size={160} value={code.id} />\r\n                                    <p id=\"qrName\" >\r\n                                        {code.text}\r\n                                    </p>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </ToPrint>\r\n                    <button id=\"printButton\" onClick={handlePrint}>\r\n                        Print codes.\r\n                    </button>\r\n                </>\r\n            )}\r\n            <button id=\"printButton\" onClick={addMarkedStudents}>\r\n                Print codes for marked students.\r\n            </button>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Print;\r\n","import { spreadsheetID } from \"./api/spreadsheetID\";\r\nimport config from \"./api/config\";\r\nimport header from \"./api/header\";\r\n\r\nconst { GoogleSpreadsheet } = require(\"google-spreadsheet\");\r\n\r\nconst MAX_COLUMN = 26;\r\nconst ASCII_A = 65;\r\n\r\nlet sheetKey;\r\nif (process.env.NODE_ENV === \"development\")\r\n{\r\n    console.log(\"Development mode\");\r\n    sheetKey = \"development\";\r\n}\r\nelse\r\n{\r\n    console.log(\"Production mode\");\r\n    sheetKey = \"production\";\r\n}\r\n\r\nconst dateFormatOptions = [\r\n    { year: \"numeric\", month: \"numeric\", day: \"numeric\" },\r\n    { year: \"2-digit\", month: \"numeric\", day: \"numeric\" },\r\n    { year: \"numeric\", month: \"2-digit\", day: \"numeric\" },\r\n    { year: \"2-digit\", month: \"2-digit\", day: \"numeric\" },\r\n    { year: \"numeric\", month: \"numeric\", day: \"2-digit\" },\r\n    { year: \"2-digit\", month: \"numeric\", day: \"2-digit\" },\r\n    { year: \"numeric\", month: \"2-digit\", day: \"2-digit\" },\r\n    { year: \"2-digit\", month: \"2-digit\", day: \"2-digit\" },\r\n];\r\n\r\nconst _MS_PER_DAY = 1000 * 60 * 60 * 24;\r\nfunction dateDiffInDays(a, b) {\r\n    // https://stackoverflow.com/questions/3224834/get-difference-between-2-dates-in-javascript\r\n    // Discard the time and time-zone information.\r\n    const utc1 = Date.UTC(a.getFullYear(), a.getMonth(), a.getDate());\r\n    const utc2 = Date.UTC(b.getFullYear(), b.getMonth(), b.getDate());\r\n\r\n    return Math.abs(Math.floor((utc2 - utc1) / _MS_PER_DAY));\r\n}\r\n\r\n\r\nfunction findHeader(value, headers)\r\n{\r\n    for (let h of headers)\r\n        if (h === value) return true ;\r\n\r\n    return false;\r\n}\r\n\r\nclass Doc {\r\n    constructor() {\r\n        console.log(\"Create Doc class\");\r\n        const doc = new GoogleSpreadsheet(spreadsheetID[sheetKey]);\r\n        this.state = {doc: doc, initialized: false, sheet: null, header: null, idList: null};\r\n    }\r\n\r\n    async openDoc() {\r\n        console.log('try to read sheet');\r\n        await this.state.doc.useServiceAccountAuth(config);\r\n        console.log('Auth Done');\r\n        await this.state.doc.loadInfo(); // loads document properties and worksheets\r\n        console.log('Done');\r\n        this.state.initialized = true;\r\n    }\r\n\r\n    isOpen() {\r\n        return this.state.initialized;\r\n    }\r\n\r\n    async sheetsByTitle(arg) {\r\n        this.state.sheet = await this.state.doc.sheetsByTitle[arg];\r\n\r\n        return this.state.sheet;\r\n    }\r\n\r\n    async sheetsByDate(date) {\r\n        this.state.sheet = null;\r\n        let dateStr = null;\r\n        for (let option of dateFormatOptions) {\r\n            this.state.sheet = await this.state.doc.sheetsByTitle[date.toLocaleDateString(\"en-US\", option)];\r\n            dateStr = date.toLocaleDateString(\"en-US\", option);\r\n            if (this.state.sheet) {\r\n                break;\r\n            }\r\n        }\r\n        if (!this.state.sheet)\r\n            return null;\r\n\r\n        console.log(dateStr);\r\n        console.log(\"Found sheet \" + this.state.sheet);\r\n\r\n        // Find spreadsheet headers\r\n        await this.state.sheet.loadCells('A1:Z1');\r\n        const header = this.createHeader(this.state.sheet);\r\n        console.log(header);\r\n        const idList = await this.readList(header.id, this.state.sheet);\r\n\r\n        this.state.header = header;\r\n        this.state.idList = idList;\r\n\r\n        return {sheet: this.state.sheet, date: dateStr, header: header, idList: idList};\r\n    }\r\n\r\n    createHeader(tS = this.state.sheet)\r\n    {\r\n        let idIdx = null;\r\n        let nameIdx = null;\r\n        let classIdx = null;\r\n        let checkInIdx = null;\r\n        let checkOutIdx = null;\r\n        let printIdx = null;\r\n        if (!tS)\r\n            return {};\r\n        for (let i = 0 ; i < Math.min(MAX_COLUMN, tS.columnCount) ; i++)\r\n        {\r\n            const entry = tS.getCell(0, i);\r\n            if (entry.valueType == null) continue;\r\n            nameIdx = (findHeader(entry.value, header.name)) ? i : nameIdx;\r\n            idIdx = (findHeader(entry.value, header.id)) ? i : idIdx;\r\n            classIdx = (findHeader(entry.value, header.class)) ? i : classIdx;\r\n            checkInIdx = (findHeader(entry.value, header.checkIn)) ? i : checkInIdx;\r\n            checkOutIdx = (findHeader(entry.value, header.checkOut)) ? i : checkOutIdx;\r\n            printIdx = (findHeader(entry.value, header.print)) ? i : printIdx;\r\n        }\r\n        return {id:idIdx, name:nameIdx, class:classIdx, checkIn:checkInIdx, checkOut:checkOutIdx, print:printIdx};\r\n    }\r\n\r\n    async readList(idIdx, tS = this.state.sheet)\r\n    {\r\n        let rowIdx = 0;\r\n        const ROW_RANGE = 100;\r\n        let ids = [];\r\n        if (!tS)\r\n            return [];\r\n        let lastIdx = null;\r\n        const rowSize = tS.rowCount;\r\n        while (rowIdx < rowSize-1)\r\n        {\r\n            // Read ROW_RANGE cell\r\n            const increment = Math.min(rowSize - rowIdx, ROW_RANGE);\r\n            const query = String.fromCharCode(ASCII_A+idIdx) + (rowIdx+1) + \":\" +\r\n                          String.fromCharCode(ASCII_A+idIdx) + (rowIdx+increment);\r\n            await tS.loadCells(query);\r\n            console.log(query);\r\n\r\n            let nullCount = 0;\r\n            for (let i = 0 ; i < ROW_RANGE ; i++)\r\n            {\r\n                const entry = tS.getCell(rowIdx + i, idIdx);\r\n                let id = null;\r\n                if (entry.valueType == null)\r\n                {\r\n                    nullCount++;\r\n                }\r\n                else\r\n                {\r\n                    id = entry.value;\r\n                    lastIdx = rowIdx + i;\r\n                }\r\n                ids.push(id);\r\n            }\r\n            // If all ROW_RANGE cells are empty, stop reading\r\n            if (nullCount === ROW_RANGE) break;\r\n            rowIdx += increment;\r\n        }\r\n        ids[0] = \"\";\r\n        ids = ids.slice(0, lastIdx+1);\r\n\r\n        return ids;\r\n    }\r\n\r\n    async getStudent(id) {\r\n        const todaySheet = this.state.sheet;\r\n        if (!todaySheet)\r\n            return null;\r\n\r\n        // Locate student in the spreadsheet today\r\n        let studentNumber = id;\r\n        let studentRowNumber = this.findStudentRow(studentNumber);\r\n\r\n        if (!studentRowNumber) {\r\n            return null;\r\n        }\r\n\r\n        const header = this.state.header;\r\n        // Student ID is found\r\n        console.log(\"Student ID: \" + studentNumber + \" Index:\" + studentRowNumber);\r\n        const query = String.fromCharCode(ASCII_A) + (studentRowNumber) + \":\" +\r\n                      String.fromCharCode(ASCII_A+MAX_COLUMN-1) + (studentRowNumber);\r\n        console.log(query);\r\n        await todaySheet.loadCells(query);\r\n        const idx = studentRowNumber - 1;\r\n        console.log(\"Get Cell \" + idx + \" \" + header.name);\r\n        const name = todaySheet.getCell(idx, header.name);\r\n        const checkIn = todaySheet.getCell(idx, header.checkIn);\r\n        const checkOut = todaySheet.getCell(idx, header.checkOut);\r\n\r\n        return {idx: idx, name: name, checkIn: checkIn, checkOut: checkOut};\r\n    }\r\n\r\n    async updateCell()\r\n    {\r\n        const todaySheet = this.state.sheet;\r\n        if (!todaySheet)\r\n            return null;\r\n        await todaySheet.saveUpdatedCells();\r\n    }\r\n\r\n    findStudentRow(ID) {\r\n        const idList = this.state.idList;\r\n        console.log(\"finding student row \" + idList.length);\r\n        for (let i = 0 ; i < idList.length ; i++)\r\n        {\r\n            if (idList[i] && idList[i] === ID) return i + 1;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    async findMostRecentSheet() {\r\n        let sheetDate = new Date();\r\n        let today = new Date();\r\n        while (dateDiffInDays(today, sheetDate) < 400)\r\n        {\r\n            const sheet = await this.sheetsByDate(sheetDate);\r\n            if (sheet)\r\n                return sheet;\r\n            sheetDate.setDate(sheetDate.getDate() - 1);\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\r\nexport default Doc;\r\n\r\n","export const spreadsheetID = {production: \"1FqeRNFlZZ7aJdtYRmjZ1kRb2-sarN9aoTMGyu4jhGKs\",\r\n                              development: \"12AWolV6lI99LM6NNP1bUwYanAuNDSWRJI8X4-ozM98Q\"};\r\n","import React, { useEffect } from \"react\";\r\nimport \"./App.css\";\r\nimport Scan from \"./pages/Scan\";\r\nimport Print from \"./pages/Print\";\r\nimport { ToastContainer } from \"react-toastify\";\r\nimport { Zoom } from \"react-toastify\";\r\nimport { HashRouter as Router, Routes, Route, Link} from \"react-router-dom\";\r\nimport Doc from \"./Doc\";\r\n\r\nconst doc = new Doc();\r\nfunction App() {\r\n    useEffect(function () {\r\n        async function initialize() {\r\n            console.log(\"Initialize app\");\r\n            doc.openDoc();\r\n        }\r\n        initialize();\r\n    }, []);\r\n\r\n    return (\r\n        <Router>\r\n            <div>\r\n                <nav id=\"nav\">\r\n                    <tr id=\"nav\">\r\n                        <td id=\"nav\">\r\n                            <Link to=\"/\">Scan</Link>\r\n                        </td>\r\n                        <td id=\"nav\">\r\n                            <Link to=\"/print\">Print</Link>\r\n                        </td>\r\n                    </tr>\r\n                </nav>\r\n            </div>\r\n\r\n            <hr />\r\n\r\n            <div className=\"App\">\r\n                <Routes>\r\n                    <Route path=\"/\" element={<Scan doc={doc} />} />\r\n                    <Route path=\"print\" element={<Print doc={doc}/>} />\r\n                </Routes>\r\n\r\n                <ToastContainer\r\n                    position=\"bottom-center\"\r\n                    autoClose={3000}\r\n                    hideProgressBar={false}\r\n                    newestOnTop\r\n                    closeOnClick\r\n                    rtl={false}\r\n                    draggable\r\n                    pauseOnHover\r\n                    pauseOnFocusLoss={false}\r\n                    transition={Zoom}\r\n                    icon={false}\r\n                />\r\n                <h2>\r\n                    v 1.8.1\r\n                </h2>\r\n            </div>\r\n        </Router>\r\n    );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}